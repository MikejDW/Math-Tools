<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epsilon-Delta Definition of Continuity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .slider-label {
            font-size: 1.2rem; /* Larger font size for ε and δ */
        }
        .slider-value {
            font-family: monospace;
            font-size: 1.1rem;
        }
        canvas {
            cursor: crosshair;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Epsilon-Delta Definition of Continuity</h1>
            <p class="text-md text-gray-600 mt-2">An interactive visualization</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
            <!-- Graph (takes 3 columns on large screens) -->
            <div class="lg:col-span-3 bg-white p-4 rounded-xl shadow-lg flex justify-center items-center">
                <canvas id="graph-canvas"></canvas>
            </div>

            <!-- Controls Panel (takes 2 columns on large screens) -->
            <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold mb-6 border-b pb-3">Controls</h2>
                
                <!-- Function Selector -->
                <div class="mb-6">
                    <label for="function-select" class="block text-sm font-medium text-gray-700 mb-2">Select a Function f(x):</label>
                    <select id="function-select" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="x^2" selected>x²</option>
                        <option value="sin(x)">sin(x)</option>
                        <option value="step">Step Function (discontinuous)</option>
                        <option value="x^3-x">x³ - x</option>
                    </select>
                </div>

                <!-- Sliders -->
                <div class="space-y-6">
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="c-slider" class="block slider-label text-gray-700">c = <span id="c-value" class="slider-value text-blue-600">1.00</span></label>
                        </div>
                        <p class="text-xs text-gray-500 mb-1">The point on the x-axis we are testing.</p>
                        <input id="c-slider" type="range" min="-2.5" max="2.5" value="1" step="0.01" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="epsilon-slider" class="block slider-label text-green-600">ε = <span id="epsilon-value" class="slider-value">0.50</span></label>
                        </div>
                         <p class="text-xs text-gray-500 mb-1">The "challenge" distance from f(c).</p>
                        <input id="epsilon-slider" type="range" min="0.05" max="2" value="0.5" step="0.01" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="delta-slider" class="block slider-label text-red-600">δ = <span id="delta-value" class="slider-value">0.20</span></label>
                        </div>
                        <p class="text-xs text-gray-500 mb-1">Your "response" distance from c.</p>
                        <input id="delta-slider" type="range" min="0.01" max="2" value="0.2" step="0.01" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                </div>
                
                <!-- Explanation Box -->
                <div id="explanation-box" class="mt-8 p-4 rounded-lg transition-colors duration-300">
                    <!-- Dynamic content will go here -->
                </div>
            </div>
        </div>

        <!-- Definition Section -->
        <div class="mt-8 bg-white p-6 rounded-xl shadow-lg">
            <h3 class="text-2xl font-bold mb-4">The Formal Definition</h3>
            <p class="text-gray-700">A function <span class="font-mono">f</span> is <strong>continuous</strong> at a point <span class="font-mono">c</span> if for every number <span class="font-mono text-green-600">ε > 0</span>, there exists a number <span class="font-mono text-red-600">δ > 0</span> such that:</p>
            <div class="bg-gray-100 p-4 rounded-md mt-4 text-center">
                <p class="text-lg font-mono">if <span class="text-blue-600">|x - c| < δ</span>, then <span class="text-blue-600">|f(x) - f(c)| < ε</span></p>
            </div>
            <p class="mt-4 text-gray-600"><strong>In simpler terms:</strong> If you give me any small "epsilon" (ε) distance around the y-value <span class="font-mono">f(c)</span>, I can find a "delta" (δ) distance around the x-value <span class="font-mono">c</span> such that for any <span class="font-mono">x</span> within that delta-interval, the corresponding <span class="font-mono">f(x)</span> is guaranteed to be inside the epsilon-interval.</p>
        </div>

    </div>

    <script>
        // --- DOM ELEMENTS ---
        const canvas = document.getElementById('graph-canvas');
        const ctx = canvas.getContext('2d');

        const functionSelect = document.getElementById('function-select');
        const cSlider = document.getElementById('c-slider');
        const epsilonSlider = document.getElementById('epsilon-slider');
        const deltaSlider = document.getElementById('delta-slider');

        const cValueSpan = document.getElementById('c-value');
        const epsilonValueSpan = document.getElementById('epsilon-value');
        const deltaValueSpan = document.getElementById('delta-value');
        const explanationBox = document.getElementById('explanation-box');

        // --- GRAPH STATE ---
        let state = {
            c: 1,
            epsilon: 0.5,
            delta: 0.2,
            funcName: 'x^2',
            isSuccess: false
        };

        // --- FUNCTION DEFINITIONS ---
        const functions = {
            'x^2': x => x * x,
            'sin(x)': x => Math.sin(x * 2), // Scaled for better visualization
            'step': x => (x < 1 ? -1 : 1),
            'x^3-x': x => x*x*x - x,
        };

        // --- CANVAS & DRAWING CONSTANTS ---
        let width, height, scaleX, scaleY, originX, originY;

        // --- SETUP & RESIZE ---
        function setupCanvas() {
            const container = canvas.parentElement;
            const dpr = window.devicePixelRatio || 1;
            const rect = container.getBoundingClientRect();
            
            width = rect.width;
            height = width * 0.75; // Maintain aspect ratio
            
            canvas.width = width * dpr;
            canvas.height = height * dpr;
            canvas.style.width = `${width}px`;
            canvas.style.height = `${height}px`;

            ctx.scale(dpr, dpr);

            // Establish coordinate system
            scaleX = width / 6;
            scaleY = height / 6;
            originX = width / 2;
            originY = height / 2;
            
            draw();
        }

        // --- COORDINATE TRANSFORMATION ---
        const toCanvasX = x => originX + x * scaleX;
        const toCanvasY = y => originY - y * scaleY;
        const fromCanvasX = canvasX => (canvasX - originX) / scaleX;

        // --- DRAWING FUNCTIONS ---
        function drawAxes() {
            ctx.strokeStyle = '#ccc';
            ctx.lineWidth = 1;
            ctx.beginPath();
            // X-Axis
            ctx.moveTo(0, originY);
            ctx.lineTo(width, originY);
            // Y-Axis
            ctx.moveTo(originX, 0);
            ctx.lineTo(originX, height);
            ctx.stroke();

            // Axis labels
            ctx.fillStyle = '#999';
            ctx.font = '12px Inter';
            for (let i = -3; i <= 3; i++) {
                if (i !== 0) {
                    ctx.fillText(i, toCanvasX(i) - 4, originY + 15);
                    ctx.fillText(i, originX + 5, toCanvasY(i) + 4);
                }
            }
        }

        function drawFunction(func) {
            ctx.strokeStyle = '#3b82f6'; // Blue
            ctx.lineWidth = 2.5;
            ctx.beginPath();
            
            let firstPoint = true;
            for (let px = 0; px <= width; px++) {
                const x = fromCanvasX(px);
                const y = func(x);
                if (Math.abs(y) > 4) { // Prevent drawing extreme values
                    firstPoint = true;
                    continue;
                }
                const canvasY = toCanvasY(y);
                if (firstPoint) {
                    ctx.moveTo(px, canvasY);
                    firstPoint = false;
                } else {
                    ctx.lineTo(px, canvasY);
                }
            }
            ctx.stroke();
        }

        function drawEpsilonDelta() {
            const { c, epsilon, delta, funcName } = state;
            const func = functions[funcName];
            const fc = func(c);

            // --- Draw Epsilon Band (the challenge) ---
            ctx.fillStyle = 'rgba(34, 197, 94, 0.15)'; // Green transparent
            const y_plus_eps = toCanvasY(fc + epsilon);
            const y_minus_eps = toCanvasY(fc - epsilon);
            ctx.fillRect(0, y_plus_eps, width, y_minus_eps - y_plus_eps);
            ctx.strokeStyle = 'rgba(34, 197, 94, 0.4)';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(0, y_plus_eps);
            ctx.lineTo(width, y_plus_eps);
            ctx.moveTo(0, y_minus_eps);
            ctx.lineTo(width, y_minus_eps);
            ctx.stroke();
            ctx.setLineDash([]);


            // --- Draw Delta Interval (the response) ---
            ctx.fillStyle = 'rgba(239, 68, 68, 0.15)'; // Red transparent
            const x_plus_delta = toCanvasX(c + delta);
            const x_minus_delta = toCanvasX(c - delta);
            ctx.fillRect(x_minus_delta, 0, x_plus_delta - x_minus_delta, height);
            ctx.strokeStyle = 'rgba(239, 68, 68, 0.4)';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(x_plus_delta, 0);
            ctx.lineTo(x_plus_delta, height);
            ctx.moveTo(x_minus_delta, 0);
            ctx.lineTo(x_minus_delta, height);
            ctx.stroke();
            ctx.setLineDash([]);

            // --- Check for success and draw function inside delta ---
            state.isSuccess = true;
            ctx.lineWidth = 4;
            ctx.beginPath();
            let firstPoint = true;

            for (let x = c - delta; x <= c + delta; x += 0.005) {
                const y = func(x);
                // Check if f(x) is within the epsilon band
                if (Math.abs(y - fc) >= epsilon) {
                    state.isSuccess = false;
                }
                
                const canvasX = toCanvasX(x);
                const canvasY = toCanvasY(y);
                if (firstPoint) {
                    ctx.moveTo(canvasX, canvasY);
                    firstPoint = false;
                } else {
                    ctx.lineTo(canvasX, canvasY);
                }
            }
            // Color the line based on success
            ctx.strokeStyle = state.isSuccess ? '#16a34a' : '#dc2626'; // Bright Green or Red
            ctx.stroke();

            // --- Draw the point (c, f(c)) ---
            ctx.fillStyle = '#1d4ed8';
            ctx.beginPath();
            ctx.arc(toCanvasX(c), toCanvasY(fc), 6, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();
        }
        
        function updateExplanation() {
            const { c, epsilon, delta, isSuccess, funcName } = state;
            
            if (funcName === 'step' && c === 1) {
                 explanationBox.className = 'mt-8 p-4 rounded-lg bg-yellow-100 text-yellow-800';
                 explanationBox.innerHTML = `
                    <h4 class="font-bold">Discontinuity!</h4>
                    <p class="text-sm">This function has a jump at c=1. Notice that for a small ε (like 0.5), no matter how small you make δ, the function values jump outside the green ε-band. This means it's <strong>not continuous</strong> here.</p>
                 `;
                 return;
            }

            if (isSuccess) {
                explanationBox.className = 'mt-8 p-4 rounded-lg bg-green-100 text-green-800';
                explanationBox.innerHTML = `
                    <h4 class="font-bold">Success!</h4>
                    <p class="text-sm">For this ε, your chosen δ works! The entire portion of the graph within the red δ-interval stays inside the green ε-band.</p>
                    <p class="text-sm mt-2"><strong>Challenge:</strong> Can you find a smaller δ that also works? (Hint: Yes!)</p>
                `;
            } else {
                explanationBox.className = 'mt-8 p-4 rounded-lg bg-red-100 text-red-800';
                explanationBox.innerHTML = `
                    <h4 class="font-bold">Try Again!</h4>
                    <p class="text-sm">This δ is too large for the given ε. Part of the function inside the red δ-interval escapes the green ε-band.</p>
                    <p class="text-sm mt-2"><strong>Goal:</strong> Try making δ smaller to keep the function within the green band.</p>
                `;
            }
        }


        // --- MAIN DRAW LOOP ---
        function draw() {
            if (!ctx) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawAxes();
            drawFunction(functions[state.funcName]);
            drawEpsilonDelta();
            updateExplanation();
        }

        // --- EVENT LISTENERS ---
        function updateStateAndDraw(newState) {
            Object.assign(state, newState);
            
            cValueSpan.textContent = state.c.toFixed(2);
            epsilonValueSpan.textContent = state.epsilon.toFixed(2);
            deltaValueSpan.textContent = state.delta.toFixed(2);
            
            // For step function, lock c at the point of discontinuity
            if (state.funcName === 'step') {
                cSlider.value = 1;
                state.c = 1;
                cValueSpan.textContent = state.c.toFixed(2);
            }
            
            draw();
        }

        cSlider.addEventListener('input', e => updateStateAndDraw({ c: parseFloat(e.target.value) }));
        epsilonSlider.addEventListener('input', e => updateStateAndDraw({ epsilon: parseFloat(e.target.value) }));
        deltaSlider.addEventListener('input', e => updateStateAndDraw({ delta: parseFloat(e.target.value) }));
        functionSelect.addEventListener('change', e => updateStateAndDraw({ funcName: e.target.value }));
        
        canvas.addEventListener('mousemove', (e) => {
            if (e.buttons === 1) { // If left mouse button is pressed
                const rect = canvas.getBoundingClientRect();
                const canvasX = e.clientX - rect.left;
                const newC = fromCanvasX(canvasX);
                
                if (newC >= -2.5 && newC <= 2.5) {
                    cSlider.value = newC;
                    updateStateAndDraw({ c: newC });
                }
            }
        });

        // --- INITIALIZATION ---
        window.addEventListener('resize', setupCanvas);
        window.addEventListener('load', () => {
            updateStateAndDraw(state); // Set initial text values
            setupCanvas();
        });

    </script>
</body>
</html>
